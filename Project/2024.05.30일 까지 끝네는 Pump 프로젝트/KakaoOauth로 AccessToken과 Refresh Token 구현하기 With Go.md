
### 들어가기 앞서서
![[Pasted image 20240507201026.png]]
저희는 어떤 서비스를 이용할 때 종종 위의 유명한 회사들인 구글, 카카오, 네이버들의 아이디와 패스워드를 이용해 쉽게 로그인 하고는 합니다. 저희는 이런 서비스를 통해 아주 손쉽게 회원가입 및 로그인을 진행할 수 있죠
그렇기에 이번 포스트에서는 위처럼 아주 편한 로그인(지칭 oauth)에 대해서 알아보려고 합니다

- Oauth가 무엇이죠?
- Oauth의 효용이 뭐야?
- KaKao Oauth 사용해보기
- Kakao Oauth를 Go언어로 구현해보기 
  
### Oauth가 무엇이죠? 
Oauth란 Open Authorization 약자로써 사용자 인증 단계를 타 서비스에 위임하는 것을 뜻합니다. 위에서 언급했듯이 사용자들이 손쉽게 로그인 해주는 프로토콜입니다. 아마 글을 읽으면 이러한 기능이 생긴 이유를 지레 짐작하셨을 겁니다. oauth가 생긴이유는 바로 "귀찮음"이죠. 생각해보세요 앱의 사용자들이 어떤 서비스를 이용할 때마다 계속해서 ID와 Password를 입력한다면 그것은 매우 귀찮을 것이고 같은 현상이 반복되는 것은 더욱더 역사적으로 봤을떄 좋지 못해요. 그래서 oauth가 생긴 이유죠.

### Oauth의 효용이 뭐야
아무래도 로그인 과정을 직접 구현하기 않고 위임하다 보니 개발 과정이 편합니다. 실제로 개발을 해보면 로그인 구현은 뚝딱이죠! 또한 사용자의 비밀정보를 저희 서버가 직접 저장하지 않다 보니 사용자의 데이터를 보호할 수 있습니다. 왜냐하면 Oauth는 사용자의 인가를 위임하는 것이기 떄문이죠! 

그러나 반면에 좋지 않은 결과를 불러올 수 있어요. 만에하나 구글같은 서버가 갑자기 따운되었다고 생각해보죠 그러면 Google Oauth를 일시적으로 사용할 못할테니 저희는 그 시간동안 많은 사용자들은 버려버리는 결과가 초래되죠 이처럼 인가과정이 어떠한 누군가에 의존되기 때문에 위험할 수 있어요.

### Kakao Oauth 사용해보기
그러면 한번 대한민국의 대표 메신저 앱인 kakao의 oauth를 사용해 볼까요? 
아래의 그림은 카카오톡의  Oauth 흐름도에요. 보시다싶이 Service Client와 kakao Auth Server가 존재하고 그 중간을 중개하는 Service Server가 존재합니다. 

여기서 첫 번째로 Service Client(휴대폰, 웹)가 요청을 Service Server에게 요청을 하게 됩니다.

이 요청을 받은 서버는 KaKao Auth Server에게 요청을 하면 반환값으로 어떤 url이 오게 되고 그 url를 service client에게 임시적으로 redirect 시켜 줍니다. 그런데 여기서 이 url은 카카오 서버로 요청이 바로 되는 url 이며 카카오의 ID와 Password를 입력하게 됩니다. 즉 카카오가 인증을 처리하는 셈이죠

그런 뒤 동의가 되면 Service Server가 사전에 카카오에 Service Client의 어떠한 정보를 받을 선택할 수 있습니다. 고로 정보를 받는 함은 개인정보를 받다로 이어지기 떄문에 동의 화면이 출력이 되고 사용자들은 동의하게 됩니다.

그러면 kakao auth server가 Service Server에게 다시 요청을 하게 되고 이때 state, code 값이 넘어오게 됩니다. code는 해당 
![[kakao oauth 처리 흐름도.png]]